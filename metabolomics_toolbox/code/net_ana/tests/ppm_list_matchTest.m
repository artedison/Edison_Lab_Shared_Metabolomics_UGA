function tests=ppm_list_matchTest
  tests=functiontests(localfunctions);
end

function testsimplerun(testCase)
  ppmlist={[-0.000117598057077339	0.0573866054902868	0.876670179188786;
            -0.000420251759958190	0.0573866054902868	0.876670179188786;
            -0.000117598057077339	0.0573866054902868	0.876367525485905;
            -0.000117598057077339	0.0573866054902868	0.876367525485905;
            -0.000117598057077339	0.0573866054902868	0.876367525485905],
           [-7.97819237602915e-05	-0.00552451331404291	0.0579973529059208;
            -7.97819237602915e-05	-0.00552451331404291	0.0579973529059208;
            -7.97819237602915e-05	-0.00552451331404291	0.0579973529059208;
            -7.97819237602915e-05	-0.00552451331404291	0.0579973529059208;
            -7.97819237602915e-05	-0.00552451331404291	0.0579973529059208],
           [8.16588004817209e-05	-0.00536492014032353	0.0572707376789371;
            -0.000220928918451879	-0.00536492014032353	0.0572707376789371;
            -0.000220928918451879	-0.00536492014032353	0.0572707376789371;
            -0.000220928918451879	-0.00536492014032353	0.0572707376789371;
            8.16588004817209e-05	-0.00536492014032353	0.0572707376789371]};
  namelist={{'somethingelse'	'unknown'	'unknown'},{'somethingelse'	'unknown'	'unknown'},{'somethingelse'	'unknown'	'unknown'}};
  pattern='[uU]nknown.*';
  deltapm_threshold=0.01;
  [ppmmatch_ind ppmvec]=ppm_list_match(ppmlist,namelist,pattern,deltapm_threshold);
  match_flag=isequal(ppmmatch_ind',[2,3,3]);
  ppm_est_flag=(ppmvec-0.057)<0.001;
  verifyTrue(testCase,match_flag&ppm_est_flag);
end

function testexcept(testCase)
  ppmlist={[-0.000117598057077339	0.0573866054902868	0.876670179188786;
            -0.000420251759958190	0.0573866054902868	0.876670179188786;
            -0.000117598057077339	0.0573866054902868	0.876367525485905;
            -0.000117598057077339	0.0573866054902868	0.876367525485905;
            -0.000117598057077339	0.0573866054902868	0.876367525485905],
           [-7.97819237602915e-05	-0.00552451331404291	0.0579973529059208;
            -7.97819237602915e-05	-0.00552451331404291	0.0579973529059208;
            -7.97819237602915e-05	-0.00552451331404291	0.0579973529059208;
            -7.97819237602915e-05	-0.00552451331404291	0.0579973529059208;
            -7.97819237602915e-05	-0.00552451331404291	0.0579973529059208],
           [8.16588004817209e-05	-0.00536492014032353	0.0572707376789371;
            -0.000220928918451879	-0.00536492014032353	0.0572707376789371;
            -0.000220928918451879	-0.00536492014032353	0.0572707376789371;
            -0.000220928918451879	-0.00536492014032353	0.0572707376789371;
            8.16588004817209e-05	-0.00536492014032353	0.0572707376789371]};
  namelist={{'somethingelse'	'unknown'	'unknown'},{'somethingelse'	'unknown'	'unknown'},{'somethingelse'	'unknown'	'unknown'}};
  pattern='[uU]nknown.*';
  deltapm_threshold=0.01;
  [ppmmatch_ind ppmvec]=ppm_list_match(ppmlist,namelist,pattern,deltapm_threshold,true);
  match_flag=isequal(ppmmatch_ind',[1,1,1]);
  ppm_est_flag=(ppmvec-0)<0.001;
  verifyTrue(testCase,match_flag&ppm_est_flag);
end
